# AIæ‘„å½±å¸ˆå°ç¨‹åº - è…¾è®¯äº‘SCFå®˜æ–¹æ–‡æ¡£æ¶æ„

## ğŸ“‹ å…³é”®å‘ç°

åŸºäºè…¾è®¯äº‘SCFå®˜æ–¹æ–‡æ¡£åˆ†æï¼š

### 1. Function URL æ˜¯æ­£ç¡®çš„é€‰æ‹©
- âœ… APIç½‘å…³è§¦å‘å™¨å·²äº2024å¹´7æœˆåœç”¨ï¼Œ2025å¹´6æœˆå®Œå…¨ä¸‹çº¿
- âœ… Function URLæ˜¯å®˜æ–¹æ¨èçš„æ›¿ä»£æ–¹æ¡ˆ
- âœ… Webå‡½æ•°ç±»å‹æ”¯æŒç›´æ¥HTTPè¯·æ±‚é€ä¼ ï¼Œæ€§èƒ½æ›´å¥½
- âœ… æ— éœ€APIç½‘å…³è½¬æ¢ï¼Œé™ä½å»¶è¿Ÿå’Œæˆæœ¬

### 2. å‡½æ•°é—´è°ƒç”¨çš„æ­£ç¡®æ–¹å¼
- âœ… SCFå‡½æ•°é—´è°ƒç”¨éœ€è¦ä½¿ç”¨Invoke APIï¼ˆä¸æ˜¯ç›´æ¥å†…éƒ¨è°ƒç”¨ï¼‰
- âœ… å¯ä»¥é€šè¿‡è…¾è®¯äº‘SDKæˆ–HTTP APIè°ƒç”¨å…¶ä»–å‡½æ•°
- âœ… æ”¯æŒ åŒæ­¥è°ƒç”¨ å’Œå¼‚æ­¥è°ƒç”¨

### 3. åŸé¡¹ç›®æ¶æ„ä¼˜åŠ¿ä¿æŒ
- âœ… Actionè·¯ç”±æ¨¡å¼å®Œå…¨å¯ä»¥åœ¨SCFä¸­å®ç°
- âœ… å•ä¸€å…¥å£ + å†…éƒ¨è·¯ç”±çš„è®¾è®¡å“²å­¦ä¾ç„¶æœ‰æ•ˆ
- âœ… å¯ä»¥å……åˆ†åˆ©ç”¨SCFçš„é•¿æ—¶è¿è¡Œä¼˜åŠ¿ï¼ˆ15åˆ†é’Ÿè¶…æ—¶ï¼‰

## ğŸ—ï¸ é‡æ–°è®¾è®¡çš„æ¶æ„

### æ¶æ„åŸåˆ™
1. **ä¿æŒåŸé¡¹ç›®çš„ç®€æ´æ€§** - ä¸è¿‡åº¦æ‹†åˆ†å¾®æœåŠ¡
2. **å……åˆ†åˆ©ç”¨SCFä¼˜åŠ¿** - é•¿æ—¶è¿è¡Œã€é«˜å†…å­˜ã€å¹¶å‘å¤„ç†
3. **æœ€å°åŒ–å‡½æ•°é—´è°ƒç”¨** - å‡å°‘Invoke APIçš„ä½¿ç”¨ï¼Œé™ä½å»¶è¿Ÿ
4. **æ™ºèƒ½åˆå¹¶åŠŸèƒ½** - ç›¸å…³åŠŸèƒ½æ”¾åœ¨åŒä¸€å‡½æ•°ä¸­

### å‡½æ•°ç»“æ„è®¾è®¡

```
AIæ‘„å½±å¸ˆå°ç¨‹åº (åŸºäºå®˜æ–¹æ–‡æ¡£çš„SCFæ¶æ„)
â”œâ”€â”€ api-gateway (Webå‡½æ•°) - ç»Ÿä¸€HTTPå…¥å£
â”‚   â”œâ”€â”€ Function URL: https://xxx.scf.tencentcloudapi.com
â”‚   â”œâ”€â”€ ç”¨æˆ·è®¤è¯å’Œä¸Šä¸‹æ–‡å¤„ç†
â”‚   â”œâ”€â”€ Actionè·¯ç”±åˆ†å‘
â”‚   â””â”€â”€ ç›´æ¥å¤„ç†ç®€å•æ“ä½œ
â”‚
â”œâ”€â”€ photography-service (Webå‡½æ•°) - æ‘„å½±ä¸šåŠ¡æ ¸å¿ƒ
â”‚   â”œâ”€â”€ Function URL: https://xxx.scf.tencentcloudapi.com
â”‚   â”œâ”€â”€ æœè£…æ‘„å½±ç”Ÿæˆï¼ˆåŒ…å«çŠ¶æ€æœºï¼‰
â”‚   â”œâ”€â”€ å§¿åŠ¿å˜æ¢åŠŸèƒ½
â”‚   â”œâ”€â”€ ä½œå“ç®¡ç†å’Œæ”¶è—
â”‚   â””â”€â”€ ç›´æ¥è°ƒç”¨AI APIï¼ˆæ— éœ€å†…éƒ¨å‡½æ•°è°ƒç”¨ï¼‰
â”‚
â”œâ”€â”€ fitting-service (Webå‡½æ•°) - è¯•è¡£ä¸šåŠ¡æ ¸å¿ƒ
â”‚   â”œâ”€â”€ Function URL: https://xxx.scf.tencentcloudapi.com
â”‚   â”œâ”€â”€ è™šæ‹Ÿè¯•è¡£ç”Ÿæˆï¼ˆåŒ…å«çŠ¶æ€æœºï¼‰
â”‚   â”œâ”€â”€ è¯•è¡£ä½œå“ç®¡ç†
â”‚   â””â”€â”€ ç›´æ¥è°ƒç”¨AI APIï¼ˆæ— éœ€å†…éƒ¨å‡½æ•°è°ƒç”¨ï¼‰
â”‚
â”œâ”€â”€ user-service (Webå‡½æ•°) - ç”¨æˆ·ç®¡ç†
â”‚   â”œâ”€â”€ Function URL: https://xxx.scf.tencentcloudapi.com
â”‚   â”œâ”€â”€ ç”¨æˆ·æ³¨å†Œç™»å½•
â”‚   â”œâ”€â”€ ç§¯åˆ†ç³»ç»Ÿ
â”‚   â””â”€â”€ ç”¨æˆ·èµ„æ–™ç®¡ç†
â”‚
â”œâ”€â”€ storage-service (Webå‡½æ•°) - æ–‡ä»¶ç®¡ç†
â”‚   â”œâ”€â”€ Function URL: https://xxx.scf.tencentcloudapi.com
â”‚   â”œâ”€â”€ æ–‡ä»¶ä¸Šä¼ å’Œå»é‡
â”‚   â”œâ”€â”€ æƒé™æ§åˆ¶
â”‚   â””â”€â”€ è…¾è®¯äº‘COSé›†æˆ
â”‚
â””â”€â”€ data-service (Webå‡½æ•°) - æ•°æ®ç®¡ç†
    â”œâ”€â”€ Function URL: https://xxx.scf.tencentcloudapi.com
    â”œâ”€â”€ åœºæ™¯æ•°æ®ç®¡ç†
    â”œâ”€â”€ æç¤ºè¯æ¨¡æ¿ç®¡ç†
    â”œâ”€â”€ AIæ¨¡å‹é…ç½®
    â””â”€â”€ ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢
```

### è¯·æ±‚æµç¨‹è®¾è®¡

#### æ–¹æ¡ˆä¸€ï¼šç»Ÿä¸€å…¥å£ + æ™ºèƒ½è·¯ç”±ï¼ˆæ¨èï¼‰
```
ç”¨æˆ·è¯·æ±‚ â†’ api-gateway Function URL â†’
â”œâ”€ ç›´æ¥å¤„ç†ï¼šç”¨æˆ·æ“ä½œã€æ•°æ®æŸ¥è¯¢
â”œâ”€ Invoke APIè°ƒç”¨ï¼šphotography-serviceã€fitting-service
â””â”€ å†…éƒ¨HTTPè°ƒç”¨ï¼šstorage-serviceã€data-service
```

#### æ–¹æ¡ˆäºŒï¼šç›´æ¥æœåŠ¡è°ƒç”¨ï¼ˆé«˜æ€§èƒ½ï¼‰
```
å°ç¨‹åºç›´æ¥è°ƒç”¨å¯¹åº”æœåŠ¡çš„Function URL
â”œâ”€ æ‘„å½±ç›¸å…³ â†’ photography-service
â”œâ”€ è¯•è¡£ç›¸å…³ â†’ fitting-service
â”œâ”€ ç”¨æˆ·æ“ä½œ â†’ user-service
â””â”€ æ–‡ä»¶æ“ä½œ â†’ storage-service
```

## ğŸ”§ æŠ€æœ¯å®ç°è¦ç‚¹

### 1. Webå‡½æ•°é…ç½®ï¼ˆåŸºäºå®˜æ–¹æ–‡æ¡£ï¼‰
```yaml
functions:
  api-gateway:
    handler: api-gateway.main_handler
    type: web  # Webå‡½æ•°ç±»å‹ï¼Œè‡ªåŠ¨å¯ç”¨Function URL
    memorySize: 512
    timeout: 30
    environment:
      variables:
        FUNCTION_TYPE: api-gateway
```

### 2. å‡½æ•°å…¥å£æ ¼å¼ï¼ˆå®˜æ–¹æ ‡å‡†ï¼‰
```javascript
// æ­£ç¡®çš„SCFå…¥å£å‡½æ•°æ ¼å¼
exports.main_handler = async (event, context) => {
  // Webå‡½æ•°ç›´æ¥æ¥æ”¶HTTPè¯·æ±‚
  const { path, httpMethod, headers, body } = event

  // è¿”å›æ ‡å‡†HTTPå“åº”
  return {
    statusCode: 200,
    headers: {
      'Content-Type': 'application/json',
      'Access-Control-Allow-Origin': '*'
    },
    body: JSON.stringify({
      success: true,
      data: result
    })
  }
}
```

### 3. å‡½æ•°é—´è°ƒç”¨ï¼ˆå®˜æ–¹Invoke APIï¼‰
```javascript
// ä½¿ç”¨è…¾è®¯äº‘SDKè°ƒç”¨å…¶ä»–å‡½æ•°
const scf = require('@tencentcloud/scf-sdk')

async function callOtherFunction(functionName, payload) {
  try {
    const result = await scf.invoke({
      FunctionName: functionName,
      InvocationType: 'RequestResponse', // åŒæ­¥è°ƒç”¨
      Payload: JSON.stringify(payload)
    })
    return JSON.parse(result.Payload)
  } catch (error) {
    console.error('å‡½æ•°è°ƒç”¨å¤±è´¥:', error)
    throw error
  }
}
```

## ğŸ“Š æ¶æ„ä¼˜åŠ¿

### ç›¸æ¯”åŸå¾®ä¿¡äº‘å¼€å‘ï¼š
1. **æ›´é«˜æ€§èƒ½** - 2GBå†…å­˜ï¼Œ15åˆ†é’Ÿè¶…æ—¶
2. **æ›´å¼ºå¹¶å‘** - æ— å•å®ä¾‹é™åˆ¶
3. **æ›´ä½æˆæœ¬** - æŒ‰å®é™…ä½¿ç”¨ä»˜è´¹
4. **æ›´å¥½çš„æ‰©å±•æ€§** - å¯ç‹¬ç«‹æ‰©å±•æ¯ä¸ªæœåŠ¡

### ç›¸æ¯”è¿‡åº¦æ‹†åˆ†çš„å¾®æœåŠ¡ï¼š
1. **æ›´ä½å»¶è¿Ÿ** - å‡å°‘ä¸å¿…è¦çš„å‡½æ•°é—´è°ƒç”¨
2. **æ›´ç®€å•éƒ¨ç½²** - ç›¸å…³åŠŸèƒ½èšåˆï¼Œéƒ¨ç½²æ›´ç®€å•
3. **æ›´å¥½ç»´æŠ¤** - åŠŸèƒ½é›†ä¸­ï¼Œè°ƒè¯•æ›´å®¹æ˜“
4. **æ›´å°‘æˆæœ¬** - å‡å°‘å‡½æ•°è°ƒç”¨å¼€é”€

## ğŸ¯ å®æ–½è®¡åˆ’

### é˜¶æ®µä¸€ï¼šæ ¸å¿ƒæœåŠ¡è¿ç§»
1. åˆ›å»º api-gateway ç»Ÿä¸€å…¥å£
2. è¿ç§» user-service ç”¨æˆ·ç®¡ç†
3. è¿ç§» photography-service æ‘„å½±ä¸šåŠ¡

### é˜¶æ®µäºŒï¼šå®Œæ•´åŠŸèƒ½è¿ç§»
1. è¿ç§» fitting-service è¯•è¡£ä¸šåŠ¡
2. è¿ç§» storage-service æ–‡ä»¶ç®¡ç†
3. è¿ç§» data-service æ•°æ®ç®¡ç†

### é˜¶æ®µä¸‰ï¼šä¼˜åŒ–å’Œæµ‹è¯•
1. æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–
2. å®Œæ•´åŠŸèƒ½æµ‹è¯•
3. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

## ğŸ“ é…ç½®æ–‡ä»¶ç¤ºä¾‹

åŸºäºå®˜æ–¹æ–‡æ¡£çš„æ­£ç¡®é…ç½®ï¼š

```yaml
service: ai-photography-scf-official

provider:
  name: tencent
  runtime: Nodejs18.15
  region: ap-guangzhou
  stage: dev

functions:
  api-gateway:
    handler: api-gateway.main_handler
    type: web
    memorySize: 512
    timeout: 30

  photography-service:
    handler: photography-service.main_handler
    type: web
    memorySize: 2048
    timeout: 900

  # ... å…¶ä»–å‡½æ•°é…ç½®
```

**è¿™ä¸ªæ¶æ„å®Œå…¨åŸºäºè…¾è®¯äº‘SCFå®˜æ–¹æ–‡æ¡£ï¼Œç¡®ä¿å¯ä»¥ç›´æ¥éƒ¨ç½²å¹¶å……åˆ†åˆ©ç”¨SCFçš„ä¼˜åŠ¿ï¼**